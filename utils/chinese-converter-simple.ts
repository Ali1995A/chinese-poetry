/**
 * 简化的中文简繁转换工具
 * 只包含核心的古诗词常用字
 */

// 核心简繁对照表（去重版）
const simplifiedToTraditionalMap: Record<string, string> = {
  // 核心古诗词常用字
  '云': '雲', '后': '後', '里': '裏', '几': '幾', '郁': '鬱', '松': '鬆',
  '发': '發', '只': '隻', '斗': '鬥', '谷': '穀', '干': '乾', '舍': '捨',
  '台': '臺', '面': '麵', '回': '迴', '胡': '鬍', '须': '鬚', '采': '採',
  '冲': '衝', '获': '獲', '尽': '盡', '复': '復', '才': '纔', '闲': '閑',
  '适': '適', '蒙': '蒙', '卜': '蔔', '准': '準', '脏': '髒', '板': '闆',
  '范': '範', '借': '藉', '折': '摺', '罗': '羅', '征': '徵', '姜': '薑',
  '余': '餘', '御': '禦', '沈': '沈', '游': '遊', '于': '於', '夸': '誇',
  '党': '黨', '丑': '醜', '吊': '弔', '霉': '黴', '系': '係',
  '合': '閤', '哄': '鬨', '困': '睏', '筑': '築', '佣': '傭', '欲': '慾',
  
  // 常用扩展字
  '爱': '愛', '碍': '礙', '宝': '寶', '报': '報', '笔': '筆', '边': '邊',
  '宾': '賓', '参': '參', '仓': '倉', '产': '產', '长': '長', '车': '車',
  '齿': '齒', '虫': '蟲', '从': '從', '达': '達', '带': '帶', '单': '單',
  '当': '當', '东': '東', '动': '動', '断': '斷', '对': '對', '队': '隊',
  '尔': '爾', '丰': '豐', '风': '風', '冈': '岡', '广': '廣', '归': '歸',
  '龟': '龜', '国': '國', '过': '過', '华': '華', '画': '畫', '汇': '匯',
  '会': '會', '击': '擊', '鸡': '雞', '积': '積', '极': '極', '际': '際',
  '继': '繼', '家': '傢', '价': '價', '艰': '艱', '歼': '殲', '茧': '繭',
  '拣': '揀', '舰': '艦', '浆': '漿', '桨': '槳', '奖': '獎', '讲': '講',
  '酱': '醬', '胶': '膠', '阶': '階', '洁': '潔', '仅': '僅', '惊': '驚',
  '竞': '競', '旧': '舊', '剧': '劇', '据': '據', '惧': '懼', '卷': '捲',
  '开': '開', '克': '剋', '垦': '墾', '恳': '懇', '块': '塊', '亏': '虧',
  '腊': '臘', '蜡': '蠟', '兰': '蘭', '拦': '攔', '栏': '欄', '烂': '爛',
  '累': '纍', '垒': '壘', '类': '類', '礼': '禮', '隶': '隸', '帘': '簾',
  '联': '聯', '怜': '憐', '炼': '煉', '练': '練', '粮': '糧', '疗': '療',
  '辽': '遼', '猎': '獵', '临': '臨', '邻': '鄰', '岭': '嶺', '庐': '廬',
  '芦': '蘆', '炉': '爐', '陆': '陸', '驴': '驢', '乱': '亂', '么': '麼',
  '梦': '夢', '庙': '廟', '灭': '滅', '亩': '畝', '恼': '惱',
  '脑': '腦', '拟': '擬', '酿': '釀', '疟': '瘧', '盘': '盤', '辟': '闢',
  '苹': '蘋', '凭': '憑', '扑': '撲', '仆': '僕', '朴': '樸', '启': '啟',
  '签': '簽', '千': '韆', '牵': '牽', '纤': '縴', '窍': '竅', '窃': '竊',
  '寝': '寢', '庆': '慶', '琼': '瓊', '秋': '鞦', '曲': '麯', '权': '權',
  '劝': '勸', '确': '確', '让': '讓', '扰': '擾', '热': '熱', '认': '認',
  '洒': '灑', '伞': '傘', '丧': '喪', '扫': '掃', '涩': '澀', '晒': '曬',
  '伤': '傷', '声': '聲', '胜': '勝', '湿': '濕', '实': '實', '势': '勢',
  '兽': '獸', '书': '書', '术': '術', '树': '樹', '帅': '帥', '苏': '蘇',
  '虽': '雖', '随': '隨', '态': '態', '坛': '壇', '叹': '歎',
  '誊': '謄', '体': '體', '铁': '鐵', '听': '聽', '厅': '廳', '头': '頭',
  '图': '圖', '涂': '塗', '团': '團', '椭': '橢', '洼': '窪', '袜': '襪',
  '网': '網', '卫': '衛', '稳': '穩', '务': '務', '雾': '霧', '牺': '犧',
  '习': '習', '戏': '戲', '虾': '蝦', '吓': '嚇', '咸': '鹹', '显': '顯',
  '宪': '憲', '县': '縣', '响': '響', '向': '嚮', '协': '協', '胁': '脅',
  '亵': '褻', '衅': '釁', '兴': '興', '悬': '懸', '选': '選', '旋': '鏇',
  '压': '壓', '盐': '鹽', '阳': '陽', '养': '養', '痒': '癢', '样': '樣',
  '钥': '鑰', '药': '藥', '爷': '爺', '叶': '葉', '医': '醫', '亿': '億',
  '忆': '憶', '应': '應', '拥': '擁', '踊': '踴', '忧': '憂', '优': '優',
  '邮': '郵', '誉': '譽', '渊': '淵', '园': '園', '远': '遠', '愿': '願',
  '跃': '躍', '运': '運', '酝': '醞'
};

// 繁简对照表（反向映射）
const traditionalToSimplifiedMap: Record<string, string> = {};
Object.entries(simplifiedToTraditionalMap).forEach(([simplified, traditional]) => {
  traditionalToSimplifiedMap[traditional] = simplified;
});

/**
 * 简体转繁体
 */
export function simplifiedToTraditional(text: string): string {
  return text.split('').map(char => simplifiedToTraditionalMap[char] || char).join('');
}

/**
 * 繁体转简体
 */
export function traditionalToSimplified(text: string): string {
  return text.split('').map(char => traditionalToSimplifiedMap[char] || char).join('');
}

/**
 * 生成搜索关键词的多种形式（简体、繁体）
 */
export function generateSearchVariants(query: string): string[] {
  const variants = new Set<string>();
  
  // 原始查询
  variants.add(query);
  variants.add(query.toLowerCase());
  
  // 简体转繁体
  const traditional = simplifiedToTraditional(query);
  if (traditional !== query) {
    variants.add(traditional);
    variants.add(traditional.toLowerCase());
  }
  
  // 繁体转简体
  const simplified = traditionalToSimplified(query);
  if (simplified !== query) {
    variants.add(simplified);
    variants.add(simplified.toLowerCase());
  }
  
  return Array.from(variants);
}

/**
 * 检查文本是否包含搜索关键词（支持简繁转换）
 */
export function containsChineseText(text: string, query: string): boolean {
  const searchVariants = generateSearchVariants(query);
  const lowerText = text.toLowerCase();
  
  return searchVariants.some(variant => lowerText.includes(variant.toLowerCase()));
}